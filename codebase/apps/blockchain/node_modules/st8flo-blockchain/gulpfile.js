var gulp = require('gulp');
var concat = require('gulp-concat');
var sh = require('shelljs');
// var browserify = require('gulp-browserify');


gulp.task('compileModules', function (done) {
	return gulp.src(['src/**/*.js'])
		.pipe(concat('st8flo-blockchain.js'))
		.pipe(gulp.dest('build/'));
});

// gulp.task ('browserify', function(){
// 	return gulp.src([
// 			'node_modules/debug/src/debug.js',
// 		])
// 		.pipe(browserify())
// 		.pipe(rename('browserified.js'))
// 		.pipe(gulp.dest(config.st8flo_builddest));
// });

gulp.task('copy-codebase',['compileModules'], function(){
	sh.exec("cp -R ../st8flo-blockchain ../03_codebase/apps/blockchain/node_modules/");
	sh.exec("cd ../st8flo && gulp copy-codebase-mac");
});

gulp.task('build', ['compileModules','copy-codebase']);
gulp.task('default', ['build']);
